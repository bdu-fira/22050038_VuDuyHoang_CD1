<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Trang Ch·ªß - Shop Qu·∫ßn √Åo</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./css/index.css"/>
</head>

<body>
    <script src="config.js"></script>
    <header class="header">
        <div class="container header-container">
            <div class="logo">
                üõçÔ∏è <span>Shop Qu·∫ßn √Åo</span>
            </div>
            <nav>
                <ul class="nav-links" id="nav-links">
                    </ul>
            </nav>
        </div>
    </header>

    <main>
        <div id="carouselBanner" class="carousel-container">
            <div class="carousel-slide active">
                <img data-src="/banner.webp" alt="Banner 1">
            </div>
            <div class="carousel-slide">
                <img data-src="/banner2.webp" alt="Banner 2">
            </div>
            <div class="carousel-slide">
                <img data-src="/banner3.webp" alt="Banner 3">
            </div>
            <div class="carousel-controls">
                <button id="prevSlideBtn">&lt;</button>
                <button id="nextSlideBtn">&gt;</button>
            </div>
        </div>
        
        <h1>S·∫£n Ph·∫©m C·ªßa Ch√∫ng T√¥i</h1>
        <div class="filter-bar">
            <select id="categoryFilter">
                <option value="all">T·∫•t c·∫£</option>
                </select>

            <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm s·∫£n ph·∫©m..." />
        </div>

        <div class="product-list">
            </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const banners = document.querySelectorAll('#carouselBanner img');
            if (window.config?.IMG_URL) {
                banners.forEach(img => {
                    const fileName = img.getAttribute('data-src');
                    img.src = `${window.config.IMG_URL}${fileName}`;
                });
            } else {
                console.error('IMG_URL kh√¥ng ƒë∆∞·ª£c c·∫•u h√¨nh trong window.config');
            }
        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const navLinks = document.getElementById('nav-links');
            const userRaw = localStorage.getItem('user');
            let userData = null;
            try {
                userData = userRaw ? JSON.parse(userRaw) : null;
            } catch (e) {
                console.error('L·ªói parse user:', e);
                localStorage.removeItem('user');
            }

            const cartRaw = localStorage.getItem('cart');
            let cart = [];
            try {
                cart = cartRaw ? JSON.parse(cartRaw) : [];
            } catch (e) {
                console.error('L·ªói parse cart:', e);
                localStorage.removeItem('cart');
            }

            const cartCount = cart.reduce((total, item) => total + item.soLuong, 0);

            if (userData?.user?.khachHang?.hoTen) {
                const hoTen = userData.user.khachHang.hoTen;

                navLinks.innerHTML = `
                    <li><a href="index.html">Trang Ch·ªß</a></li>
                    <li><span>üë§ Xin ch√†o, ${hoTen}</span></li>
                    <li><a href="#" id="logout-btn">ƒêƒÉng Xu·∫•t</a></li>
                    <li><a href="cart.html">üõí Gi·ªè H√†ng (<span id="cart-count">${cartCount}</span>)</a></li>
                    <li><a href="donhang.html">ƒê∆°n H√†ng</a></li>
                `;

                document.getElementById('logout-btn').addEventListener('click', () => {
                    localStorage.removeItem('user');
                    localStorage.removeItem('token');
                    location.reload();
                });
            } else {
                navLinks.innerHTML = `
                    <li><a href="index.html">Trang Ch·ªß</a></li>
                    <li><a href="login.html">ƒêƒÉng Nh·∫≠p</a></li>
                    <li><a href="register.html">ƒêƒÉng K√Ω</a></li>
                    <li><a href="cart.html">üõí Gi·ªè H√†ng (<span id="cart-count">${cartCount}</span>)</a></li>
                `;
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            const carouselContainer = document.getElementById('carouselBanner');
            const slides = document.querySelectorAll('.carousel-slide');
            const prevButton = document.getElementById('prevSlideBtn');
            const nextButton = document.getElementById('nextSlideBtn');
            const totalSlides = slides.length;
            let currentSlide = 0;
            let intervalId;
            const intervalTime = 3000;

            function showSlide(index) {
                slides.forEach((slide, i) => {
                    slide.classList.remove('active');
                    if (i === index) {
                        slide.classList.add('active');
                    }
                });
            }

            function nextSlide() {
                currentSlide = (currentSlide + 1) % totalSlides;
                showSlide(currentSlide);
            }

            function prevSlide() {
                currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
                showSlide(currentSlide);
            }

            function startCarousel() {
                intervalId = setInterval(nextSlide, intervalTime);
            }

            function stopCarousel() {
                clearInterval(intervalId);
            }

            // Hi·ªÉn th·ªã slide ƒë·∫ßu ti√™n
            showSlide(currentSlide);

            // B·∫Øt ƒë·∫ßu t·ª± ƒë·ªông chuy·ªÉn slide
            startCarousel();

            // X·ª≠ l√Ω s·ª± ki·ªán click cho n√∫t Previous
            prevButton.addEventListener('click', () => {
                stopCarousel();
                prevSlide();
                startCarousel(); // Kh·ªüi ƒë·ªông l·∫°i t·ª± ƒë·ªông chuy·ªÉn sau khi t∆∞∆°ng t√°c
            });

            // X·ª≠ l√Ω s·ª± ki·ªán click cho n√∫t Next
            nextButton.addEventListener('click', () => {
                stopCarousel();
                nextSlide();
                startCarousel(); // Kh·ªüi ƒë·ªông l·∫°i t·ª± ƒë·ªông chuy·ªÉn sau khi t∆∞∆°ng t√°c
            });

            // T√πy ch·ªçn: D·ª´ng carousel khi di chu·ªôt v√†o v√† ti·∫øp t·ª•c khi r·ªùi chu·ªôt
            // carouselContainer.addEventListener('mouseenter', stopCarousel);
            // carouselContainer.addEventListener('mouseleave', startCarousel);
        });
    </script>

    <script type="module" src="js/index.js"></script>

</body>

</html>